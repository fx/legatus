function F(j){let q=j/1e6;if(q<1)return`${Math.round(j/1000)}us`;if(q<1000)return`${Math.round(q)}ms`;let k=q/1000;if(k<60)return`${k.toFixed(1)}s`;return`${(k/60).toFixed(1)}m`}function G(j,q=new Date){let k=new Date(j);if(Number.isNaN(k.getTime()))return"Unknown";let y=q.getTime()-k.getTime(),A=Math.floor(y/1000),z=Math.floor(A/60),B=Math.floor(z/60);if(B>=24)return k.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"});if(y<0)return"just now";if(A<60)return A<=5?"just now":`${A}s ago`;if(z<60)return`${z}m ago`;return`${B}h ago`}function I(j,q){let k=j.results?.[0],y="unknown",A="Unknown";if(k)if(k.success)y="healthy",A="Healthy";else y="unhealthy",A="Unhealthy";let z={index:q,name:j.name,group:j.group||null,key:j.key,statusClass:y,statusLabel:A,hasResult:!!k};if(k){if(z.formattedDuration=F(k.duration),z.formattedTimestamp=G(k.timestamp),z.httpStatus=k.status||null,z.hasConditions=k.conditionResults?.length>0,z.hasConditions&&k.conditionResults)z.conditions=k.conditionResults.map((B)=>({condition:B.condition,icon:B.success?"✓":"✗",iconClass:B.success?"condition-icon-success":"condition-icon-failure"}))}return z}function J(j){return{endpoints:j.map((q,k)=>I(q,k))}}var K={STORAGE_KEYS:{theme:"gatus-minimal:theme",colorMode:"gatus-minimal:color-mode"},DEFAULTS:{theme:"gatus",colorMode:"system"},VALID_THEMES:["github","gatus","tui"],VALID_COLOR_MODES:["light","dark","system"],getConfig(){if(typeof localStorage>"u")return{...this.DEFAULTS};let j=localStorage.getItem(this.STORAGE_KEYS.theme),q=localStorage.getItem(this.STORAGE_KEYS.colorMode),k=this.VALID_THEMES.includes(j)?j:this.DEFAULTS.theme,y=this.VALID_COLOR_MODES.includes(q)?q:this.DEFAULTS.colorMode;return{theme:k,colorMode:y}},setTheme(j){if(!this.VALID_THEMES.includes(j))return;localStorage.setItem(this.STORAGE_KEYS.theme,j),document.documentElement.setAttribute("data-theme",j)},setColorMode(j){if(!this.VALID_COLOR_MODES.includes(j))return;localStorage.setItem(this.STORAGE_KEYS.colorMode,j),document.documentElement.setAttribute("data-color-mode",j)},applyConfig(){let j=this.getConfig();document.documentElement.setAttribute("data-theme",j.theme),document.documentElement.setAttribute("data-color-mode",j.colorMode)},syncUI(){let j=this.getConfig(),q=document.getElementById("theme-select"),k=document.getElementById("color-mode-select");if(q)q.value=j.theme;if(k)k.value=j.colorMode},init(){this.applyConfig(),this.syncUI();let j=document.getElementById("theme-select"),q=document.getElementById("color-mode-select");if(j)j.addEventListener("change",(k)=>{let y=k.target;this.setTheme(y.value)});if(q)q.addEventListener("change",(k)=>{let y=k.target;this.setColorMode(y.value)})}};if(typeof document<"u")K.init(),document.body.addEventListener("htmx:configRequest",(j)=>{let q=j.detail;q.headers.Accept="application/json"}),document.body.addEventListener("htmx:beforeSwap",(j)=>{let q=j.detail;if(q.target.id==="app"&&q.xhr.responseURL.includes("/api/v1/endpoints/statuses"))try{let k=JSON.parse(q.xhr.responseText),y=J(k);q.serverResponse=JSON.stringify(y)}catch(k){if(console.error("Failed to preprocess endpoints:",k),q.shouldSwap=!1,q.target&&"innerHTML"in q.target)q.target.innerHTML='<div class="error-message">Unable to load endpoint statuses. Please try again later.</div>'}});export{J as preprocessEndpoints,I as preprocessEndpoint,G as formatTimestamp,F as formatDuration,K as ThemeController};
