function G(q){let k=q/1e6;if(k<1)return`${Math.round(q/1000)}us`;if(k<1000)return`${Math.round(k)}ms`;let j=k/1000;if(j<60)return`${j.toFixed(1)}s`;return`${(j/60).toFixed(1)}m`}function J(q,k=new Date){let j=new Date(q);if(Number.isNaN(j.getTime()))return"Unknown";let z=k.getTime()-j.getTime(),A=Math.floor(z/1000),B=Math.floor(A/60),y=Math.floor(B/60);if(y>=24)return j.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"});if(z<0)return"just now";if(A<60)return A<=5?"just now":`${A}s ago`;if(B<60)return`${B}m ago`;return`${y}h ago`}function K(q,k){let j=q.results?.[0],z="unknown",A="Unknown",B="--";if(j)if(j.success)z="healthy",A="Healthy",B="OK";else z="unhealthy",A="Unhealthy",B="!!";let y={index:k,name:q.name,group:q.group||null,key:q.key,statusClass:z,statusLabel:A,statusIcon:B,hasResult:!!j};if(j){if(y.formattedDuration=G(j.duration),y.formattedTimestamp=J(j.timestamp),y.httpStatus=j.status||null,y.hasConditions=j.conditionResults?.length>0,y.hasConditions&&j.conditionResults)y.conditions=j.conditionResults.map((F)=>({condition:F.condition,icon:F.success?"✓":"✗",iconClass:F.success?"condition-icon-success":"condition-icon-failure"}))}return y}function N(q){return{endpoints:q.map((k,j)=>K(k,j))}}if(typeof document<"u")document.body.addEventListener("htmx:configRequest",(q)=>{let k=q.detail;k.headers.Accept="application/json"}),document.body.addEventListener("htmx:beforeSwap",(q)=>{let k=q.detail;if(k.target.id==="app"&&k.xhr.responseURL.includes("/api/v1/endpoints/statuses"))try{let j=JSON.parse(k.xhr.responseText),z=N(j);k.serverResponse=JSON.stringify(z)}catch(j){if(console.error("Failed to preprocess endpoints:",j),k.shouldSwap=!1,k.target&&"innerHTML"in k.target)k.target.innerHTML='<div class="error-message">Unable to load endpoint statuses. Please try again later.</div>'}});export{N as preprocessEndpoints,K as preprocessEndpoint,J as formatTimestamp,G as formatDuration};
