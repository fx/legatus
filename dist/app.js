function F(q){let k=q/1e6;if(k<1)return`${Math.round(q/1000)}us`;if(k<1000)return`${Math.round(k)}ms`;let j=k/1000;if(j<60)return`${j.toFixed(1)}s`;return`${(j/60).toFixed(1)}m`}function G(q,k=new Date){let j=new Date(q);if(Number.isNaN(j.getTime()))return"Unknown";let z=k.getTime()-j.getTime(),A=Math.floor(z/1000),y=Math.floor(A/60),B=Math.floor(y/60);if(B>=24)return j.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"});if(z<0)return"just now";if(A<60)return A<=5?"just now":`${A}s ago`;if(y<60)return`${y}m ago`;return`${B}h ago`}function I(q,k){let j=q.results?.[0],z="unknown",A="Unknown";if(j)if(j.success)z="healthy",A="Healthy";else z="unhealthy",A="Unhealthy";let y={index:k,name:q.name,group:q.group||null,key:q.key,statusClass:z,statusLabel:A,hasResult:!!j};if(j){if(y.formattedDuration=F(j.duration),y.formattedTimestamp=G(j.timestamp),y.httpStatus=j.status||null,y.hasConditions=j.conditionResults?.length>0,y.hasConditions&&j.conditionResults)y.conditions=j.conditionResults.map((B)=>({condition:B.condition,icon:B.success?"✓":"✗",iconClass:B.success?"condition-icon-success":"condition-icon-failure"}))}return y}function J(q){return{endpoints:q.map((k,j)=>I(k,j))}}if(typeof document<"u")document.body.addEventListener("htmx:configRequest",(q)=>{let k=q.detail;k.headers.Accept="application/json"}),document.body.addEventListener("htmx:beforeSwap",(q)=>{let k=q.detail;if(k.target.id==="app"&&k.xhr.responseURL.includes("/api/v1/endpoints/statuses"))try{let j=JSON.parse(k.xhr.responseText),z=J(j);k.serverResponse=JSON.stringify(z)}catch(j){console.error("Failed to preprocess endpoints:",j)}});export{J as preprocessEndpoints,I as preprocessEndpoint,G as formatTimestamp,F as formatDuration};
